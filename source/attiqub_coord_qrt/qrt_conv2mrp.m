%%#######################################################################
% #######################################################################
% ###                                                                 ###
% ###  @@@@@@@@ @@@@@@@ @@@@@@@ @@@@@ @@@@@@@@@ @@@    @@@ @@@@@@@@   ###
% ###  @@@@@@@@ @@@@@@@ @@@@@@@ @@@@@ @@    (@@ @@@    @@@ @@@  @@@   ###
% ###  @@    @@   @@@     @@@    @@@  @@    (@@ @@@    @@@ @@@@@@@@@  ###
% ###  @@@@@@@@   @@@     @@@    @@@  @@@@@@@@@ @@@    @@@ @@@@@@@@@  ###
% ###  @@    @@   @@@     @@@   @@@@@ @@@@@@@@@ @@@@@@@@@@ @@@   @@@  ###
% ###  @@    @@   @@@     @@@   @@@@@     (@@@  @@@@@@@@@@ @@@@@@@@@  ###
% ###                                                                 ###
% ### Project ATTIQUB: Quarternions Toolbox                           ###
% ### Conversion of a quarternion into Modified Rodrigues Parameters  ###
% ###                                                                 ###
% ### By Samuel Low (13-12-2020), DSO National Laboratories           ###
% ###                                                                 ###
% #######################################################################
% #######################################################################

function [mrp] = qrt_conv2mrp(quarternion)

% Input: 1x4 quarternion row vector [b0, b1, b2, b3].
% Output: 1x3 MRP vector.

m1 = quarternion(2) / ( 1 + quarternion(1) );
m2 = quarternion(3) / ( 1 + quarternion(1) );
m3 = quarternion(4) / ( 1 + quarternion(1) );
mrp = [m1 m2 m3];

end

