%%#######################################################################
% #######################################################################
% ###                                                                 ###
% ###  @@@@@@@@ @@@@@@@ @@@@@@@ @@@@@ @@@@@@@@@ @@@    @@@ @@@@@@@@   ###
% ###  @@@@@@@@ @@@@@@@ @@@@@@@ @@@@@ @@    (@@ @@@    @@@ @@@  @@@   ###
% ###  @@    @@   @@@     @@@    @@@  @@    (@@ @@@    @@@ @@@@@@@@@  ###
% ###  @@@@@@@@   @@@     @@@    @@@  @@@@@@@@@ @@@    @@@ @@@@@@@@@  ###
% ###  @@    @@   @@@     @@@   @@@@@ @@@@@@@@@ @@@@@@@@@@ @@@   @@@  ###
% ###  @@    @@   @@@     @@@   @@@@@     (@@@  @@@@@@@@@@ @@@@@@@@@  ###
% ###                                                                 ###
% ### Project ATTIQUB: Modified Rodrigues Parameters Toolbox          ###
% ### Conversion of a MRP into direction cosine matrix form           ###
% ###                                                                 ###
% ### By Samuel Low (15-12-2020), DSO National Laboratories           ###
% ###                                                                 ###
% #######################################################################
% #######################################################################

function [dcm] = mrp_conv2dcm(mrp)

% Input: 1x3 MRP vector
% Output: 3x3 DCM

% Express the MRP with cross-product operator in tilde form.
mt = [ 0.0        (-1*mrp(3))   mrp(2)      ;
       mrp(3)      0.0         (-1*mrp(1))  ;
      (-1*mrp(2))  mrp(1)       0.0        ];

% Now we can form the DCM.
dcm = 8* (mt * mt) - 4 * ( 1 - dot(mrp,mrp) ) * mt;
dcm = dcm / ( ( 1 + dot(mrp,mrp) )^2 );
dcm = dcm + eye(3);

end

